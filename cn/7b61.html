<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="theme-color" content="#f8f5ec"><meta name="msapplication-navbutton-color" content="#f8f5ec"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec"><meta name="referrer" content="same-origin"><meta name="referrer" content="no-referrer"><meta name="description" content="牛客网SQL题目"><meta name="keywords" content="大数据,BigData,数据开发,Hadoop,Spark,Flink,Hive,HBase"><link rel="alternate" href="/cn/atom.xml" title="马攀的技术栈"><link rel="shortcut icon" type="image/x-icon" href="/cn/favicon.ico?v=2.11.0"><link rel="canonical" href="https://mapan.tech/cn/7b61.html"><link rel="stylesheet" type="text/css" href="/cn/css/style.css?v=2.11.0"><script>window.config={toc:!0,fancybox:!1,pjax:!1,latex:!1}</script><title>牛客网SQL题目 - 马攀的技术栈</title></head><body><div id="mobile-navbar" class="mobile-navbar"><div class="mobile-header-logo"><a href="/cn/." class="logo">马攀的技术栈</a></div><div class="mobile-navbar-icon"><span></span> <span></span> <span></span></div></div><nav id="mobile-menu" class="mobile-menu slideout-menu"><ul class="mobile-menu-list"><a href="/cn/"><li class="mobile-menu-item">首页</li></a><a href="/cn/categories.html"><li class="mobile-menu-item">分类</li></a><a href="/cn/about.html"><li class="mobile-menu-item">关于</li></a><a href="/cn/message.html"><li class="mobile-menu-item">留言</li></a><a href="/cn/links.html"><li class="mobile-menu-item">友链</li></a></ul></nav><div class="container" id="mobile-panel"><header id="header" class="header"><div class="logo-wrapper"><a href="https://mapan.tech" class="logo">马攀的技术栈</a></div><nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item"><a class="menu-item-link" href="/cn/">首页</a></li><li class="menu-item"><a class="menu-item-link" href="/cn/categories.html">分类</a></li><li class="menu-item"><a class="menu-item-link" href="/cn/about.html">关于</a></li><li class="menu-item"><a class="menu-item-link" href="/cn/message.html">留言</a></li><li class="menu-item"><a class="menu-item-link" href="/cn/links.html">友链</a></li></ul></nav></header><main id="main" class="main"><div class="content-wrapper"><div id="content" class="content"><article class="post"><header class="post-header"><h1 class="post-title">牛客网SQL题目</h1><div class="post-meta"><span class="post-time">2020-01-04 </span><span class="post-category"><a href="/cn/categories/SQL/">SQL</a> </span><span id="/cn/7b61.html" class="leancloud-visitors" data-flag-title="牛客网SQL题目">阅读数 <span class="leancloud-visitors-count">1000</span> </span><span class="post-count">字数统计 2.7k </span><span class="post-count">阅读时长 14</span></div></header><div class="post-toc" id="post-toc"><h2 class="post-toc-title">文章目录</h2><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#第01题"><span class="toc-text">第01题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第02题"><span class="toc-text">第02题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第03题"><span class="toc-text">第03题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第04题"><span class="toc-text">第04题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第05题"><span class="toc-text">第05题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第06题"><span class="toc-text">第06题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第07题"><span class="toc-text">第07题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第08题"><span class="toc-text">第08题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第09题"><span class="toc-text">第09题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第10题"><span class="toc-text">第10题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第11题"><span class="toc-text">第11题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第12题"><span class="toc-text">第12题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第13题"><span class="toc-text">第13题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第14题"><span class="toc-text">第14题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第15题"><span class="toc-text">第15题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第16题"><span class="toc-text">第16题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第17题"><span class="toc-text">第17题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第18题"><span class="toc-text">第18题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第19题"><span class="toc-text">第19题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第20题"><span class="toc-text">第20题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第21题"><span class="toc-text">第21题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第22题"><span class="toc-text">第22题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第22-61题"><span class="toc-text">第22-61题</span></a></li></ol></div></div><div class="post-content"><p>牛客网题目 <a href="https://www.nowcoder.com/ta/sql">https://www.nowcoder.com/ta/sql</a><br>共计61道题目，现已全部完成</p><h2 id="第01题"><a href="#第01题" class="headerlink" title="第01题"></a>第01题</h2><ul><li>题目描述：查找最晚入职员工的所有信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`employees`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`birth_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`first_name`</span> <span class="built_in">varchar</span>(<span class="number">14</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`last_name`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`gender`</span> <span class="built_in">char</span>(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`hire_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">emp_no</th><th style="text-align:left">birth_date</th><th style="text-align:left">first_name</th><th style="text-align:left">last_name</th><th style="text-align:left">gender</th><th style="text-align:left">hire_date</th></tr></thead><tbody><tr><td style="text-align:left">10008</td><td style="text-align:left">1958-02-19</td><td style="text-align:left">Saniya</td><td style="text-align:left">Kalloufi</td><td style="text-align:left">M</td><td style="text-align:left">1994-09-15</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * </span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> hire_date=(<span class="keyword">select</span> hire_date <span class="keyword">from</span> employees <span class="keyword">order</span> <span class="keyword">by</span> hire_date <span class="keyword">desc</span> <span class="keyword">limit</span> <span class="number">1</span> )</span><br></pre></td></tr></table></figure><h2 id="第02题"><a href="#第02题" class="headerlink" title="第02题"></a>第02题</h2><ul><li>题目描述：查找入职员工时间排名倒数第三的员工所有信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`employees`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`birth_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`first_name`</span> <span class="built_in">varchar</span>(<span class="number">14</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`last_name`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`gender`</span> <span class="built_in">char</span>(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`hire_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">emp_no</th><th style="text-align:left">birth_date</th><th style="text-align:left">first_name</th><th style="text-align:left">last_name</th><th style="text-align:left">gender</th><th style="text-align:left">hire_date</th></tr></thead><tbody><tr><td style="text-align:left">10005</td><td style="text-align:left">1955-01-21</td><td style="text-align:left">Kyoichi</td><td style="text-align:left">Maliniak</td><td style="text-align:left">M</td><td style="text-align:left">1989-09-12</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> employees </span><br><span class="line"><span class="keyword">where</span> hire_date=(</span><br><span class="line">    <span class="keyword">select</span> hire_date </span><br><span class="line">    <span class="keyword">from</span> employees</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> hire_date </span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> hire_date <span class="keyword">desc</span></span><br><span class="line">    <span class="keyword">limit</span> <span class="number">2</span>,<span class="number">1</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="第03题"><a href="#第03题" class="headerlink" title="第03题"></a>第03题</h2><ul><li>题目描述：查找各个部门当前(to_date=’9999-01-01’)领导当前薪水详情以及其对应部门编号dept_no</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`dept_manager`</span> (</span><br><span class="line"><span class="string">`dept_no`</span> <span class="built_in">char</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`dept_no`</span>));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`salaries`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`salary`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`from_date`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">emp_no</th><th style="text-align:left">salary</th><th style="text-align:left">from_date</th><th style="text-align:left">to_date</th><th style="text-align:left">dept_no</th></tr></thead><tbody><tr><td style="text-align:left">10002</td><td style="text-align:left">72527</td><td style="text-align:left">2001-08-02</td><td style="text-align:left">9999-01-01</td><td style="text-align:left">d001</td></tr><tr><td style="text-align:left">10004</td><td style="text-align:left">74057</td><td style="text-align:left">2001-11-27</td><td style="text-align:left">9999-01-01</td><td style="text-align:left">d004</td></tr><tr><td style="text-align:left">10005</td><td style="text-align:left">94692</td><td style="text-align:left">2001-09-09</td><td style="text-align:left">9999-01-01</td><td style="text-align:left">d003</td></tr><tr><td style="text-align:left">10006</td><td style="text-align:left">43311</td><td style="text-align:left">2001-08-02</td><td style="text-align:left">9999-01-01</td><td style="text-align:left">d002</td></tr><tr><td style="text-align:left">10010</td><td style="text-align:left">94409</td><td style="text-align:left">2001-11-23</td><td style="text-align:left">9999-01-01</td><td style="text-align:left">d006</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">    t2.*,</span><br><span class="line">    t1.dept_no</span><br><span class="line"><span class="keyword">from</span> salaries <span class="keyword">as</span> t2</span><br><span class="line"><span class="keyword">join</span> dept_manager <span class="keyword">as</span> t1</span><br><span class="line"><span class="keyword">on</span> t1.emp_no=t2.emp_no</span><br><span class="line"><span class="keyword">where</span> t1.to_date=<span class="string">'9999-01-01'</span></span><br><span class="line"><span class="keyword">and</span> t2.to_date=<span class="string">'9999-01-01'</span>;</span><br></pre></td></tr></table></figure><h2 id="第04题"><a href="#第04题" class="headerlink" title="第04题"></a>第04题</h2><ul><li>题目描述：查找所有已经分配部门的员工的last_name和first_name</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`dept_emp`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`dept_no`</span> <span class="built_in">char</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`dept_no`</span>));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`employees`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`birth_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`first_name`</span> <span class="built_in">varchar</span>(<span class="number">14</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`last_name`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`gender`</span> <span class="built_in">char</span>(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`hire_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">last_name</th><th style="text-align:left">first_name</th><th style="text-align:left">dept_no</th></tr></thead><tbody><tr><td style="text-align:left">Facello</td><td style="text-align:left">Georgi</td><td style="text-align:left">d001</td></tr><tr><td style="text-align:left">省略</td><td style="text-align:left">省略</td><td style="text-align:left">省略</td></tr><tr><td style="text-align:left">Piveteau</td><td style="text-align:left">Duangkaew</td><td style="text-align:left">d006</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    t1.last_name,</span><br><span class="line">    t1.first_name,</span><br><span class="line">    t2.dept_no</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    employees <span class="keyword">as</span> t1,</span><br><span class="line">    dept_emp <span class="keyword">as</span> t2</span><br><span class="line"><span class="keyword">where</span> t1.emp_no=t2.emp_no</span><br><span class="line"><span class="keyword">and</span> t2.dept_no <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>;</span><br></pre></td></tr></table></figure><h2 id="第05题"><a href="#第05题" class="headerlink" title="第05题"></a>第05题</h2><ul><li>题目描述：查找所有员工的last_name和first_name以及对应部门编号dept_no，也包括展示没有分配具体部门的员工</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`dept_emp`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`dept_no`</span> <span class="built_in">char</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`dept_no`</span>));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`employees`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`birth_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`first_name`</span> <span class="built_in">varchar</span>(<span class="number">14</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`last_name`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`gender`</span> <span class="built_in">char</span>(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`hire_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">last_name</th><th style="text-align:left">first_name</th><th style="text-align:left">dept_no</th></tr></thead><tbody><tr><td style="text-align:left">Facello</td><td style="text-align:left">Georgi</td><td style="text-align:left">d001</td></tr><tr><td style="text-align:left">省略</td><td style="text-align:left">省略</td><td style="text-align:left">省略</td></tr><tr><td style="text-align:left">Sluis</td><td style="text-align:left">Mary</td><td style="text-align:left">NULL(在sqlite中此处为空,MySQL为NULL)</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    t2.last_name,</span><br><span class="line">    t2.first_name,</span><br><span class="line">    t1.dept_no</span><br><span class="line"><span class="keyword">from</span> employees <span class="keyword">as</span> t2</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> dept_emp <span class="keyword">as</span> t1</span><br><span class="line"><span class="keyword">on</span> t1.emp_no=t2.emp_no;</span><br></pre></td></tr></table></figure><h2 id="第06题"><a href="#第06题" class="headerlink" title="第06题"></a>第06题</h2><ul><li>题目描述：查找所有员工入职时候的薪水情况，给出emp_no以及salary， 并按照emp_no进行逆序</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`employees`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`birth_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`first_name`</span> <span class="built_in">varchar</span>(<span class="number">14</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`last_name`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`gender`</span> <span class="built_in">char</span>(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`hire_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`salaries`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`salary`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`from_date`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">emp_no</th><th style="text-align:left">salary</th></tr></thead><tbody><tr><td style="text-align:left">10011</td><td style="text-align:left">25828</td></tr><tr><td style="text-align:left">省略</td><td style="text-align:left">省略</td></tr><tr><td style="text-align:left">10001</td><td style="text-align:left">60117</td></tr></tbody></table></div><ul><li>答案：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    t1.emp_no,</span><br><span class="line">    t2.salary</span><br><span class="line"><span class="keyword">from</span> employees <span class="keyword">as</span> t1</span><br><span class="line"><span class="keyword">join</span> salaries <span class="keyword">as</span> t2</span><br><span class="line"><span class="keyword">on</span> t1.emp_no=t2.emp_no</span><br><span class="line"><span class="keyword">where</span> t1.hire_date=t2.from_date</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> t1.emp_no <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure></li></ul><h2 id="第07题"><a href="#第07题" class="headerlink" title="第07题"></a>第07题</h2><ul><li>题目描述：查找薪水涨幅超过15次的员工号emp_no以及其对应的涨幅次数t</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`salaries`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`salary`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`from_date`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">emp_no</th><th style="text-align:left">t</th></tr></thead><tbody><tr><td style="text-align:left">10001</td><td style="text-align:left">17</td></tr><tr><td style="text-align:left">10004</td><td style="text-align:left">16</td></tr><tr><td style="text-align:left">10009</td><td style="text-align:left">18</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    emp_no,</span><br><span class="line">    <span class="keyword">count</span>(<span class="number">1</span>) <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">from</span> salaries</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> emp_no</span><br><span class="line"><span class="keyword">having</span> t&gt;<span class="number">15</span>;</span><br></pre></td></tr></table></figure><h2 id="第08题"><a href="#第08题" class="headerlink" title="第08题"></a>第08题</h2><ul><li>题目描述：找出所有员工当前(to_date=’9999-01-01’)具体的薪水salary情况，对于相同的薪水只显示一次,并按照逆序显示</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`salaries`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`salary`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`from_date`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">salary</th></tr></thead><tbody><tr><td style="text-align:left">94692</td></tr><tr><td style="text-align:left">94409</td></tr><tr><td style="text-align:left">88958</td></tr><tr><td style="text-align:left">88070</td></tr><tr><td style="text-align:left">74057</td></tr><tr><td style="text-align:left">72527</td></tr><tr><td style="text-align:left">59755</td></tr><tr><td style="text-align:left">43311</td></tr><tr><td style="text-align:left">25828</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    <span class="keyword">distinct</span> salary</span><br><span class="line"><span class="keyword">from</span> salaries</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">to_date</span>=<span class="string">'9999-01-01'</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> salary <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure><h2 id="第09题"><a href="#第09题" class="headerlink" title="第09题"></a>第09题</h2><ul><li>题目描述：获取所有部门当前manager的当前薪水情况，给出dept_no, emp_no以及salary，当前表示to_date=’9999-01-01’</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`dept_manager`</span> (</span><br><span class="line"><span class="string">`dept_no`</span> <span class="built_in">char</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`dept_no`</span>));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`salaries`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`salary`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`from_date`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">dept_no</th><th style="text-align:left">emp_no</th><th style="text-align:left">salary</th></tr></thead><tbody><tr><td style="text-align:left">d001</td><td style="text-align:left">10002</td><td style="text-align:left">72527</td></tr><tr><td style="text-align:left">d004</td><td style="text-align:left">10004</td><td style="text-align:left">74057</td></tr><tr><td style="text-align:left">d003</td><td style="text-align:left">10005</td><td style="text-align:left">94692</td></tr><tr><td style="text-align:left">d002</td><td style="text-align:left">10006</td><td style="text-align:left">43311</td></tr><tr><td style="text-align:left">d006</td><td style="text-align:left">10010</td><td style="text-align:left">94409</td></tr></tbody></table></div><ul><li>答案：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    t2.dept_no,</span><br><span class="line">    t2.emp_no,</span><br><span class="line">    t1.salary</span><br><span class="line"><span class="keyword">from</span> salaries <span class="keyword">as</span> t1</span><br><span class="line"><span class="keyword">join</span> dept_manager <span class="keyword">as</span> t2</span><br><span class="line"><span class="keyword">on</span> t1.emp_no=t2.emp_no</span><br><span class="line"><span class="keyword">where</span> t1.to_date=<span class="string">'9999-01-01'</span></span><br><span class="line"><span class="keyword">and</span> t2.to_date=<span class="string">'9999-01-01'</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="第10题"><a href="#第10题" class="headerlink" title="第10题"></a>第10题</h2><ul><li>题目描述：获取所有非manager的员工emp_no</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`dept_manager`</span> (</span><br><span class="line"><span class="string">`dept_no`</span> <span class="built_in">char</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`dept_no`</span>));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`employees`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`birth_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`first_name`</span> <span class="built_in">varchar</span>(<span class="number">14</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`last_name`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`gender`</span> <span class="built_in">char</span>(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`hire_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">emp_no</th></tr></thead><tbody><tr><td style="text-align:left">10001</td></tr><tr><td style="text-align:left">10003</td></tr><tr><td style="text-align:left">10007</td></tr><tr><td style="text-align:left">10008</td></tr><tr><td style="text-align:left">10009</td></tr><tr><td style="text-align:left">10011</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    t1.emp_no</span><br><span class="line"><span class="keyword">from</span> employees <span class="keyword">as</span> t1</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> dept_manager <span class="keyword">as</span> t2</span><br><span class="line"><span class="keyword">on</span> t1.emp_no=t2.emp_no</span><br><span class="line"><span class="keyword">where</span> t2.dept_no <span class="keyword">is</span> <span class="literal">null</span>;</span><br></pre></td></tr></table></figure><h2 id="第11题"><a href="#第11题" class="headerlink" title="第11题"></a>第11题</h2><ul><li>题目描述： 获取所有员工当前的manager，如果当前的manager是自己的话结果不显示，当前表示to_date=’9999-01-01’。<br>结果第一列给出当前员工的emp_no,第二列给出其manager对应的manager_no。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`dept_emp`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`dept_no`</span> <span class="built_in">char</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`dept_no`</span>));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`dept_manager`</span> (</span><br><span class="line"><span class="string">`dept_no`</span> <span class="built_in">char</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`dept_no`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">emp_no</th><th style="text-align:left">manager_no</th></tr></thead><tbody><tr><td style="text-align:left">10001</td><td style="text-align:left">10002</td></tr><tr><td style="text-align:left">10003</td><td style="text-align:left">10004</td></tr><tr><td style="text-align:left">10009</td><td style="text-align:left">10010</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    t1.emp_no,</span><br><span class="line">    t2.emp_no <span class="keyword">as</span> manager_no</span><br><span class="line"><span class="keyword">from</span> dept_emp <span class="keyword">as</span> t1</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> dept_manager <span class="keyword">as</span> t2</span><br><span class="line"><span class="keyword">on</span> t1.dept_no=t2.dept_no</span><br><span class="line"><span class="keyword">where</span> t1.to_date=<span class="string">'9999-01-01'</span></span><br><span class="line"><span class="keyword">and</span> t2.to_date=<span class="string">'9999-01-01'</span></span><br><span class="line"><span class="keyword">and</span> t1.emp_no&lt;&gt;t2.emp_no;</span><br></pre></td></tr></table></figure><h2 id="第12题"><a href="#第12题" class="headerlink" title="第12题"></a>第12题</h2><ul><li>题目描述：获取所有部门中当前员工薪水最高的相关信息，给出dept_no, emp_no以及其对应的salary</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`dept_emp`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`dept_no`</span> <span class="built_in">char</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`dept_no`</span>));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`salaries`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`salary`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`from_date`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">dept_no</th><th style="text-align:left">emp_no</th><th style="text-align:left">salary</th></tr></thead><tbody><tr><td style="text-align:left">d001</td><td style="text-align:left">10001</td><td style="text-align:left">88958</td></tr><tr><td style="text-align:left">d002</td><td style="text-align:left">10006</td><td style="text-align:left">43311</td></tr><tr><td style="text-align:left">d003</td><td style="text-align:left">10005</td><td style="text-align:left">94692</td></tr><tr><td style="text-align:left">d004</td><td style="text-align:left">10004</td><td style="text-align:left">74057</td></tr><tr><td style="text-align:left">d005</td><td style="text-align:left">10007</td><td style="text-align:left">88070</td></tr><tr><td style="text-align:left">d006</td><td style="text-align:left">10009</td><td style="text-align:left">95409</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    t1.dept_no, </span><br><span class="line">    t1.emp_no, </span><br><span class="line">    t2.salary</span><br><span class="line"><span class="keyword">from</span> dept_emp <span class="keyword">as</span> t1 </span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> salaries <span class="keyword">as</span> t2</span><br><span class="line"><span class="keyword">on</span> t1.emp_no = t2.emp_no</span><br><span class="line"><span class="keyword">and</span> t1.to_date = <span class="string">'9999-01-01'</span></span><br><span class="line"><span class="keyword">and</span> t2.to_date = <span class="string">'9999-01-01'</span></span><br><span class="line"><span class="keyword">where</span> t2.salary = (</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">max</span>(t3.salary)</span><br><span class="line">    <span class="keyword">from</span> dept_emp <span class="keyword">as</span> t4</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> salaries <span class="keyword">as</span> t3</span><br><span class="line">    <span class="keyword">on</span> t3.emp_no = t4.emp_no</span><br><span class="line">    <span class="keyword">and</span> t3.to_date = <span class="string">'9999-01-01'</span></span><br><span class="line">    <span class="keyword">and</span> t4.to_date = <span class="string">'9999-01-01'</span></span><br><span class="line">    <span class="keyword">where</span> t4.dept_no = t1.dept_no</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> t4.dept_no)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> t1.dept_no;</span><br></pre></td></tr></table></figure><h2 id="第13题"><a href="#第13题" class="headerlink" title="第13题"></a>第13题</h2><ul><li>题目描述：从titles表获取按照title进行分组，每组个数大于等于2，给出title以及对应的数目t。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> <span class="string">"titles"</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`title`</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">title</th><th style="text-align:left">t</th></tr></thead><tbody><tr><td style="text-align:left">Assistant Engineer</td><td style="text-align:left">2</td></tr><tr><td style="text-align:left">Engineer</td><td style="text-align:left">4</td></tr><tr><td style="text-align:left">省略</td><td style="text-align:left">省略</td></tr><tr><td style="text-align:left">Staff</td><td style="text-align:left">3</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    title,</span><br><span class="line">    <span class="keyword">count</span>(<span class="number">1</span>) <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">from</span> titles</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> title</span><br><span class="line"><span class="keyword">having</span> t&gt;=<span class="number">2</span>;</span><br></pre></td></tr></table></figure><h2 id="第14题"><a href="#第14题" class="headerlink" title="第14题"></a>第14题</h2><ul><li>题目描述：从titles表获取按照title进行分组，每组个数大于等于2，给出title以及对应的数目t。<br>注意对于重复的emp_no进行忽略。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> <span class="string">`titles`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`title`</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">title</th><th style="text-align:left">t</th></tr></thead><tbody><tr><td style="text-align:left">Assistant Engineer</td><td style="text-align:left">2</td></tr><tr><td style="text-align:left">Engineer</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left">省略</td><td style="text-align:left">省略</td></tr><tr><td style="text-align:left">Staff</td><td style="text-align:left">3</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    title,</span><br><span class="line">    <span class="keyword">count</span>(<span class="keyword">distinct</span> emp_no) <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">from</span> titles</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> title;</span><br></pre></td></tr></table></figure><h2 id="第15题"><a href="#第15题" class="headerlink" title="第15题"></a>第15题</h2><ul><li>题目描述：查找employees表所有emp_no为奇数，且last_name不为Mary的员工信息，并按照hire_date逆序排列</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`employees`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`birth_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`first_name`</span> <span class="built_in">varchar</span>(<span class="number">14</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`last_name`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`gender`</span> <span class="built_in">char</span>(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`hire_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">emp_no</th><th style="text-align:left">birth_date</th><th style="text-align:left">first_name</th><th style="text-align:left">last_name</th><th style="text-align:left">gender</th><th style="text-align:left">hire_date</th></tr></thead><tbody><tr><td style="text-align:left">10011</td><td style="text-align:left">1953-11-07</td><td style="text-align:left">Mary</td><td style="text-align:left">Sluis</td><td style="text-align:left">F</td><td style="text-align:left">1990-01-22</td></tr><tr><td style="text-align:left">10005</td><td style="text-align:left">1955-01-21</td><td style="text-align:left">Kyoichi</td><td style="text-align:left">Maliniak</td><td style="text-align:left">M</td><td style="text-align:left">1989-09-12</td></tr><tr><td style="text-align:left">10007</td><td style="text-align:left">1957-05-23</td><td style="text-align:left">Tzvetan</td><td style="text-align:left">Zielinski</td><td style="text-align:left">F</td><td style="text-align:left">1989-02-10</td></tr><tr><td style="text-align:left">10003</td><td style="text-align:left">1959-12-03</td><td style="text-align:left">Parto</td><td style="text-align:left">Bamford</td><td style="text-align:left">M</td><td style="text-align:left">1986-08-28</td></tr><tr><td style="text-align:left">10001</td><td style="text-align:left">1953-09-02</td><td style="text-align:left">Georgi</td><td style="text-align:left">Facello</td><td style="text-align:left">M</td><td style="text-align:left">1986-06-26</td></tr><tr><td style="text-align:left">10009</td><td style="text-align:left">1952-04-19</td><td style="text-align:left">Sumant</td><td style="text-align:left">Peac</td><td style="text-align:left">F</td><td style="text-align:left">1985-02-18</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> emp_no&amp;<span class="number">1</span>=<span class="number">1</span></span><br><span class="line"><span class="keyword">and</span> last_name&lt;&gt;<span class="string">"Mary"</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> hire_date <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure><h2 id="第16题"><a href="#第16题" class="headerlink" title="第16题"></a>第16题</h2><ul><li>题目描述：统计出当前各个title类型对应的员工当前（to_date=’9999-01-01’）薪水对应的平均工资。结果给出title以及平均工资avg。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`salaries`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`salary`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`from_date`</span>));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> <span class="string">"titles"</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`title`</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">title</th><th style="text-align:left">avg</th></tr></thead><tbody><tr><td style="text-align:left">Engineer</td><td style="text-align:left">94409.0</td></tr><tr><td style="text-align:left">Senior Engineer</td><td style="text-align:left">69009.2</td></tr><tr><td style="text-align:left">Senior Staff</td><td style="text-align:left">91381.0</td></tr><tr><td style="text-align:left">Staff</td><td style="text-align:left">72527.0</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    title,</span><br><span class="line">    <span class="keyword">avg</span>(salary) <span class="keyword">as</span> <span class="keyword">avg</span></span><br><span class="line"><span class="keyword">from</span> salaries <span class="keyword">as</span> t1</span><br><span class="line"><span class="keyword">join</span> titles <span class="keyword">as</span> t2</span><br><span class="line"><span class="keyword">on</span> t1.emp_no=t2.emp_no</span><br><span class="line"><span class="keyword">and</span> t1.to_date=<span class="string">'9999-01-01'</span></span><br><span class="line"><span class="keyword">and</span> t2.to_date=<span class="string">'9999-01-01'</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> t2.title;</span><br></pre></td></tr></table></figure><h2 id="第17题"><a href="#第17题" class="headerlink" title="第17题"></a>第17题</h2><ul><li>题目描述：获取当前（to_date=’9999-01-01’）薪水第二多的员工的emp_no以及其对应的薪水salary</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`salaries`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`salary`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`from_date`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">emp_no</th><th style="text-align:left">salary</th></tr></thead><tbody><tr><td style="text-align:left">10009</td><td style="text-align:left">94409</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    emp_no,</span><br><span class="line">    salary</span><br><span class="line"><span class="keyword">from</span> salaries</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">to_date</span>=<span class="string">'9999-01-01'</span></span><br><span class="line"><span class="keyword">and</span> salary=(</span><br><span class="line">    <span class="keyword">select</span> salary</span><br><span class="line">    <span class="keyword">from</span> salaries</span><br><span class="line">    <span class="keyword">where</span> <span class="keyword">to_date</span>=<span class="string">'9999-01-01'</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> salary</span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> salary <span class="keyword">desc</span></span><br><span class="line">    <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="第18题"><a href="#第18题" class="headerlink" title="第18题"></a>第18题</h2><ul><li>题目描述：查找当前薪水(to_date=’9999-01-01’)排名第二多的员工编号emp_no、薪水salary、last_name以及first_name，不准使用order by</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`employees`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`birth_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`first_name`</span> <span class="built_in">varchar</span>(<span class="number">14</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`last_name`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`gender`</span> <span class="built_in">char</span>(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`hire_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`salaries`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`salary`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`from_date`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">emp_no</th><th style="text-align:left">salary</th><th style="text-align:left">last_name</th><th style="text-align:left">first_name</th></tr></thead><tbody><tr><td style="text-align:left">10009</td><td style="text-align:left">94409</td><td style="text-align:left">Peac</td><td style="text-align:left">Sumant</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    t2.emp_no,</span><br><span class="line">    t1.salary,</span><br><span class="line">    t2.last_name,</span><br><span class="line">    t2.first_name</span><br><span class="line"><span class="keyword">FROM</span> salaries <span class="keyword">AS</span> t1</span><br><span class="line"><span class="keyword">JOIN</span> employees <span class="keyword">AS</span> t2</span><br><span class="line"><span class="keyword">ON</span> t1.emp_no=t2.emp_no</span><br><span class="line"><span class="keyword">AND</span> t1.to_date=<span class="string">'9999-01-01'</span></span><br><span class="line"><span class="keyword">WHERE</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> t3.salary)</span><br><span class="line">    <span class="keyword">FROM</span> salaries <span class="keyword">AS</span> t3</span><br><span class="line">    <span class="keyword">WHERE</span> t3.to_date=<span class="string">'9999-01-01'</span></span><br><span class="line">    <span class="keyword">AND</span> t3.salary&gt;t1.salary</span><br><span class="line">)=<span class="number">1</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> salary;</span><br></pre></td></tr></table></figure><h2 id="第19题"><a href="#第19题" class="headerlink" title="第19题"></a>第19题</h2><ul><li>题目描述：查找所有员工的last_name和first_name以及对应的dept_name，也包括暂时没有分配部门的员工</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`departments`</span> (</span><br><span class="line"><span class="string">`dept_no`</span> <span class="built_in">char</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`dept_name`</span> <span class="built_in">varchar</span>(<span class="number">40</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`dept_no`</span>));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`dept_emp`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`dept_no`</span> <span class="built_in">char</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`dept_no`</span>));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`employees`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`birth_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`first_name`</span> <span class="built_in">varchar</span>(<span class="number">14</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`last_name`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`gender`</span> <span class="built_in">char</span>(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`hire_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">last_name</th><th style="text-align:left">first_name</th><th style="text-align:left">dept_name</th></tr></thead><tbody><tr><td style="text-align:left">Facello</td><td style="text-align:left">Georgi</td><td style="text-align:left">Marketing</td></tr><tr><td style="text-align:left">省略</td><td style="text-align:left">省略</td><td style="text-align:left">省略</td></tr><tr><td style="text-align:left">Sluis</td><td style="text-align:left">Mary</td><td style="text-align:left">NULL</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    last_name,</span><br><span class="line">    first_name,</span><br><span class="line">    dept_name</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="keyword">AS</span> t1</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> dept_emp <span class="keyword">AS</span> t2</span><br><span class="line"><span class="keyword">ON</span> t1.emp_no=t2.emp_no</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> departments <span class="keyword">AS</span> t3</span><br><span class="line"><span class="keyword">ON</span> t2.dept_no=t3.dept_no;</span><br></pre></td></tr></table></figure><h2 id="第20题"><a href="#第20题" class="headerlink" title="第20题"></a>第20题</h2><ul><li>查找员工编号emp_no为10001其自入职以来的薪水salary涨幅值growth</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`salaries`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`salary`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`from_date`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">growth</th></tr></thead><tbody><tr><td style="text-align:left">28841</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">max</span>(salary)-<span class="keyword">min</span>(salary) <span class="keyword">as</span> growth</span><br><span class="line"><span class="keyword">from</span> salaries</span><br><span class="line"><span class="keyword">where</span> emp_no=<span class="number">10001</span>;</span><br></pre></td></tr></table></figure><h2 id="第21题"><a href="#第21题" class="headerlink" title="第21题"></a>第21题</h2><ul><li>题目描述：查找所有员工自入职以来的薪水涨幅情况，给出员工编号emp_no以及其对应的薪水涨幅growth，并按照growth进行升序</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`employees`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`birth_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`first_name`</span> <span class="built_in">varchar</span>(<span class="number">14</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`last_name`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`gender`</span> <span class="built_in">char</span>(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`hire_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`salaries`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`salary`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`from_date`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">emp_no</th><th style="text-align:left">growth</th></tr></thead><tbody><tr><td style="text-align:left">10011</td><td style="text-align:left">0</td></tr><tr><td style="text-align:left">省略</td><td style="text-align:left">省略</td></tr><tr><td style="text-align:left">10010</td><td style="text-align:left">54496</td></tr><tr><td style="text-align:left">10004</td><td style="text-align:left">34003</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	emp_no,</span><br><span class="line">	growth</span><br><span class="line"><span class="keyword">FROM</span>(<span class="keyword">SELECT</span></span><br><span class="line">		a.emp_no,</span><br><span class="line">		b.salary-a.salary <span class="keyword">AS</span> growth</span><br><span class="line">	<span class="keyword">FROM</span></span><br><span class="line">		(<span class="keyword">SELECT</span></span><br><span class="line">			t1.emp_no,</span><br><span class="line">			salary</span><br><span class="line">		<span class="keyword">FROM</span> </span><br><span class="line">			employees <span class="keyword">AS</span> t1,</span><br><span class="line">			salaries <span class="keyword">AS</span> t2</span><br><span class="line">		<span class="keyword">WHERE</span> t1.emp_no=t2.emp_no</span><br><span class="line">		<span class="keyword">AND</span> t1.hire_date=t2.from_date) <span class="keyword">AS</span> a,</span><br><span class="line">		(<span class="keyword">SELECT</span></span><br><span class="line">			t1.emp_no,</span><br><span class="line">			salary</span><br><span class="line">		<span class="keyword">FROM</span> </span><br><span class="line">			employees <span class="keyword">AS</span> t1,</span><br><span class="line">			salaries <span class="keyword">AS</span> t2</span><br><span class="line">		<span class="keyword">WHERE</span> t1.emp_no=t2.emp_no</span><br><span class="line">		<span class="keyword">AND</span> t2.to_date=<span class="string">'9999-01-01'</span>) <span class="keyword">AS</span> b</span><br><span class="line">	<span class="keyword">WHERE</span> a.emp_no=b.emp_no)<span class="keyword">AS</span> c</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> c.growth</span><br></pre></td></tr></table></figure><h2 id="第22题"><a href="#第22题" class="headerlink" title="第22题"></a>第22题</h2><ul><li>对所有员工的当前(to_date=’9999-01-01’)薪水按照salary进行按照1-N的排名，相同salary并列且按照emp_no升序排列</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`salaries`</span> (</span><br><span class="line"><span class="string">`emp_no`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`salary`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`from_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`to_date`</span> <span class="built_in">date</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="string">`emp_no`</span>,<span class="string">`from_date`</span>));</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">emp_no</th><th style="text-align:left">salary</th><th style="text-align:left">rank</th></tr></thead><tbody><tr><td style="text-align:left">10005</td><td style="text-align:left">94692</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left">10009</td><td style="text-align:left">94409</td><td style="text-align:left">2</td></tr><tr><td style="text-align:left">10010</td><td style="text-align:left">94409</td><td style="text-align:left">2</td></tr><tr><td style="text-align:left">10001</td><td style="text-align:left">88958</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left">10007</td><td style="text-align:left">88070</td><td style="text-align:left">4</td></tr><tr><td style="text-align:left">10004</td><td style="text-align:left">74057</td><td style="text-align:left">5</td></tr><tr><td style="text-align:left">10002</td><td style="text-align:left">72527</td><td style="text-align:left">6</td></tr><tr><td style="text-align:left">10003</td><td style="text-align:left">43311</td><td style="text-align:left">7</td></tr><tr><td style="text-align:left">10006</td><td style="text-align:left">43311</td><td style="text-align:left">7</td></tr><tr><td style="text-align:left">10011</td><td style="text-align:left">25828</td><td style="text-align:left">8</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	emp_no,</span><br><span class="line">	growth</span><br><span class="line"><span class="keyword">FROM</span>(<span class="keyword">SELECT</span></span><br><span class="line">		a.emp_no,</span><br><span class="line">		b.salary-a.salary <span class="keyword">AS</span> growth</span><br><span class="line">	<span class="keyword">FROM</span></span><br><span class="line">		(<span class="keyword">SELECT</span></span><br><span class="line">			t1.emp_no,</span><br><span class="line">			salary</span><br><span class="line">		<span class="keyword">FROM</span> </span><br><span class="line">			employees <span class="keyword">AS</span> t1,</span><br><span class="line">			salaries <span class="keyword">AS</span> t2</span><br><span class="line">		<span class="keyword">WHERE</span> t1.emp_no=t2.emp_no</span><br><span class="line">		<span class="keyword">AND</span> t1.hire_date=t2.from_date) <span class="keyword">AS</span> a,</span><br><span class="line">		(<span class="keyword">SELECT</span></span><br><span class="line">			t1.emp_no,</span><br><span class="line">			salary</span><br><span class="line">		<span class="keyword">FROM</span> </span><br><span class="line">			employees <span class="keyword">AS</span> t1,</span><br><span class="line">			salaries <span class="keyword">AS</span> t2</span><br><span class="line">		<span class="keyword">WHERE</span> t1.emp_no=t2.emp_no</span><br><span class="line">		<span class="keyword">AND</span> t2.to_date=<span class="string">'9999-01-01'</span>) <span class="keyword">AS</span> b</span><br><span class="line">	<span class="keyword">WHERE</span> a.emp_no=b.emp_no)<span class="keyword">AS</span> c</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> c.growth</span><br></pre></td></tr></table></figure><ul><li>输出示例：</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">dept_no</th><th style="text-align:left">dept_name</th><th style="text-align:left">sum</th></tr></thead><tbody><tr><td style="text-align:left">d001</td><td style="text-align:left">Marketing</td><td style="text-align:left">24</td></tr><tr><td style="text-align:left">d002</td><td style="text-align:left">Finance</td><td style="text-align:left">14</td></tr><tr><td style="text-align:left">d003</td><td style="text-align:left">Human Resources</td><td style="text-align:left">13</td></tr><tr><td style="text-align:left">d004</td><td style="text-align:left">Production</td><td style="text-align:left">24</td></tr><tr><td style="text-align:left">d005</td><td style="text-align:left">Development</td><td style="text-align:left">25</td></tr><tr><td style="text-align:left">d006</td><td style="text-align:left">Quality Management</td><td style="text-align:left">25</td></tr></tbody></table></div><ul><li>答案：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    t1.dept_no,</span><br><span class="line">    t3.dept_name,</span><br><span class="line">    <span class="keyword">count</span>(t2.salary) <span class="keyword">as</span> <span class="keyword">sum</span></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    dept_emp <span class="keyword">as</span> t1,</span><br><span class="line">    salaries <span class="keyword">as</span> t2,</span><br><span class="line">    departments <span class="keyword">as</span> t3</span><br><span class="line"><span class="keyword">where</span> t3.dept_no=t1.dept_no</span><br><span class="line"><span class="keyword">and</span> t1.emp_no=t2.emp_no</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> t1.dept_no</span><br></pre></td></tr></table></figure><h2 id="第22-61题"><a href="#第22-61题" class="headerlink" title="第22-61题"></a>第22-61题</h2><p>后面太多，就不罗列上去了，附上仓库地址</p><p><a href="https://github.com/impn/nowcoder/tree/master/%E6%95%B0%E6%8D%AE%E5%BA%93SQL%E5%AE%9E%E6%88%98" target="_blank">Github仓库</a></p></div><div class="post-copyright"><p class="copyright-item"><span>原文作者: </span><a href="https://mapan.tech/cn">MaPan</a></p><p class="copyright-item"><span>原文链接: </span><a href="https://mapan.tech/cn/7b61.html">https://mapan.tech/cn/7b61.html</a></p><p class="copyright-item"><span>许可协议: </span><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a></p></div><footer class="post-footer"><nav class="post-nav"><a class="prev" href="/cn/846c.html"><i class="iconfont icon-left"></i> <span class="prev-text nav-default">三大经典排序</span> <span class="prev-text nav-mobile">上一篇</span> </a><a class="next" href="/cn/b78f.html"><span class="next-text nav-default">事实表基本概念</span> <span class="prev-text nav-mobile">下一篇</span> <i class="iconfont icon-right"></i></a></nav></footer></article></div><div class="comments" id="comments"><div id="vcomments"></div></div></div></main><footer id="footer" class="footer"><div class="social-links"><a href="/cn/atom.xml" class="iconfont icon-rss" title="rss" target="_blank"></a></div><div class="copyright"><span class="division">&nbsp;</span><span class="post-count"> 全站字数 96.2k </span><span class="copyright-year">Since 2015 <span class="heart"><i class="iconfont icon-heart"></i> </span><span class="author">MaPan</span></span></div></footer><div class="back-to-top" id="back-to-top"><i class="iconfont icon-up"></i></div></div><script src="./lib/valine/av-min.js?v=3.0.4"></script><script src="./lib/valine/Valine.min.js"></script><script type="text/javascript">new Valine({el:"#vcomments",notify:!1,verify:!0,app_id:"XtxvAXPwOzM9noIc3eyxi3AS-gzGzoHsz",app_key:"yEVQszyxb4bwLuAGU5VHnPR8",placeholder:"说点什么吧...",avatar:"mm",visitor:"ture"})</script><script type="text/javascript" src="/cn/lib/jquery/jquery.min.js"></script><script type="text/javascript" src="/cn/lib/slideout/slideout.js"></script><script type="text/javascript" src="/cn/js/src/even.js?v=2.11.0"></script></body></html>